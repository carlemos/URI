its ugly
maybe a state machine is more apropriate

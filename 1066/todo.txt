it should be done with a generalized count_if
